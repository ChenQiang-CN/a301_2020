
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>5.6. Scale heights for typical atmospheric soundings &#8212; ATSC 301</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://a301_web.eoas.ubc.ca/week5/hydrostatic_balance.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6. Week 6" href="../week6/week6_topics.html" />
    <link rel="prev" title="5.5. Pandas Cheatsheet" href="pandas-cheatsheet.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://a301_web.eoas.ubc.ca/week5/hydrostatic_balance.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Scale heights for typical atmospheric soundings" />
<meta property="og:description" content="Scale heights for typical atmospheric soundings  Plot McClatchey’s US Standard Atmospheres  There are five different average profiles for the tropics, subarctic" />


<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  
  <h1 class="site-logo" id="site-title">ATSC 301</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   ATSC 301: Fall 2020
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../week1/week1_topics.html">
   1. Week 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week2/week2_topics.html">
   2. Week 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week3/week3_topics.html">
   3. Week 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week4/week4_topics.html">
   4. Week 4
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="week5_topics.html">
   5. Week 5
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="testing.html">
     5.1. Notes on testing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="assignment3.html">
     5.2. Assignment 3: Split window H2O retrieval
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hydrostat.html">
     5.3. Hydrostatic balance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pandas_csv_intro.html">
     5.4. Reading &amp; Summarizing CSV Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pandas-cheatsheet.html">
     5.5. Pandas Cheatsheet
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     5.6. Scale heights for typical atmospheric soundings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#use-pd-dataframe-head-to-see-first-5-lines">
     5.7. Use pd.DataFrame.head to see first 5 lines
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week6/week6_topics.html">
   6. Week 6
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week7/week7_topics.html">
   7. Week 7
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week8/week8_topics.html">
   8. Week 8
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week9/week9_topics.html">
   9. Week 9
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week10/week10_topics.html">
   10. Week 10
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week11/week11_topics.html">
   11. Week 11
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week12/week12_topics.html">
   12. Week 12
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments.html">
   13. Assignments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../notebooks.html">
   14. List of notebooks
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/week5/hydrostatic_balance.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/week5/hydrostatic_balance.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/phaustin/a301_2020/master?urlpath=tree/notebooks/week5/hydrostatic_balance.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        <a class="jupyterhub-button" href="https://a301_hub.eoas.ubc.ca/hub/user-redirect/git-pull?repo=https://github.com/phaustin/a301_2020&urlpath=tree/a301_2020/notebooks/week5/hydrostatic_balance.md&branch=master"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="../_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   5.6. Scale heights for typical atmospheric soundings
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-mcclatchey-s-us-standard-atmospheres">
     5.6.1. Plot McClatchey’s US Standard Atmospheres
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#reading-the-soundings-files-into-pandas">
       5.6.1.1. Reading the soundings files into pandas
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#use-pd-dataframe-head-to-see-first-5-lines">
   5.7. Use pd.DataFrame.head to see first 5 lines
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-temp-and-vapor-mixing-ratio-rmix-rho-h2o-rho-air">
     5.7.1. Plot  temp and vapor mixing ratio rmix (
     <span class="math notranslate nohighlight">
      \(\rho_{H2O}/\rho_{air}\)
     </span>
     )
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculating-scale-heights-for-temperature-and-air-density">
     5.7.2. Calculating scale heights for temperature and air density
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#how-do-overline-h-p-and-overline-h-rho-compare-for-the-tropical-sounding">
       5.7.2.1. How do
       <span class="math notranslate nohighlight">
        \(\overline{H_p}\)
       </span>
       and
       <span class="math notranslate nohighlight">
        \(\overline{H_\rho}\)
       </span>
       compare for the tropical sounding?
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#how-well-do-these-average-values-represent-the-pressure-and-density-profiles">
       5.7.2.2. How well do these average values represent the pressure and density profiles?
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#assignment4-preview">
       5.7.2.3. Assignment4 – (preview)
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="scale-heights-for-typical-atmospheric-soundings">
<span id="scale-heights"></span><h1><span class="section-number">5.6. </span>Scale heights for typical atmospheric soundings<a class="headerlink" href="#scale-heights-for-typical-atmospheric-soundings" title="Permalink to this headline">¶</a></h1>
<div class="section" id="plot-mcclatchey-s-us-standard-atmospheres">
<h2><span class="section-number">5.6.1. </span>Plot McClatchey’s US Standard Atmospheres<a class="headerlink" href="#plot-mcclatchey-s-us-standard-atmospheres" title="Permalink to this headline">¶</a></h2>
<p>There are five different average profiles for the tropics, subarctic summer, subarctic winter, midlatitude summer, midlatitude winter.  These are called the US Standard Atmospheres.  This notebook shows how to read and plot the soundings, and calculate the pressure and density scale heights.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.ticker</span> <span class="k">as</span> <span class="nn">ticks</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">a301_lib</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pprint</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">soundings_folder</span><span class="o">=</span> <span class="n">a301_lib</span><span class="o">.</span><span class="n">data_share</span> <span class="o">/</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;soundings&#39;</span><span class="p">)</span>
<span class="n">sounding_files</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">soundings_folder</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*csv&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="reading-the-soundings-files-into-pandas">
<h3><span class="section-number">5.6.1.1. </span>Reading the soundings files into pandas<a class="headerlink" href="#reading-the-soundings-files-into-pandas" title="Permalink to this headline">¶</a></h3>
<p>There are five soundings.
The soundings have six columns and 33 rows (i.e. 33 height levels).  The variables are
z, press, temp, rmix, den, o3den – where rmix is the mixing ratio of water vapor, den is the dry air density and o3den is the ozone density.  The units are
m, pa, K, kg/kg, kg/m^3, kg/m^3</p>
<p>I will read the 6 column soundings into a <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/dsintro.html">pandas (panel data) DataFrame</a>, which is like a matrix except the columns can be accessed by column name in addition to column number.  The main advantage for us is that it’s easier to keep track of which variables we’re plotting</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">name_dict</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
<span class="n">sound_dict</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sounding_files</span><span class="p">:</span>
    <span class="n">name_dict</span><span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span><span class="o">=</span><span class="n">item</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">name_dict</span><span class="p">)</span>

<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sounding_files</span><span class="p">:</span>
    <span class="n">sound_dict</span><span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">stem</span><span class="p">]</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="use-pd-dataframe-head-to-see-first-5-lines">
<h1><span class="section-number">5.7. </span>Use pd.DataFrame.head to see first 5 lines<a class="headerlink" href="#use-pd-dataframe-head-to-see-first-5-lines" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">sound_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sounding: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">sound_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We use these keys to get a dataframe with 6 columns, and 33 levels.  Here’s an example for the midsummer sounding</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">midsummer</span><span class="o">=</span><span class="n">sound_dict</span><span class="p">[</span><span class="s1">&#39;midsummer&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">midsummer</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">list</span><span class="p">(</span><span class="n">midsummer</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="plot-temp-and-vapor-mixing-ratio-rmix-rho-h2o-rho-air">
<h2><span class="section-number">5.7.1. </span>Plot  temp and vapor mixing ratio rmix (<span class="math notranslate nohighlight">\(\rho_{H2O}/\rho_{air}\)</span>)<a class="headerlink" href="#plot-temp-and-vapor-mixing-ratio-rmix-rho-h2o-rho-air" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
<span class="n">meters2km</span><span class="o">=</span><span class="mf">1.e-3</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,(</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">)</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="k">for</span> <span class="n">a_name</span><span class="p">,</span><span class="n">df</span> <span class="ow">in</span> <span class="n">sound_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">meters2km</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">a_name</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">40</span><span class="p">),</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Temp soundings&#39;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Height (km)&#39;</span><span class="p">,</span>
       <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;rmix&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1.e3</span><span class="p">,</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">meters2km</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">a_name</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Vapor soundings&#39;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Height (km)&#39;</span><span class="p">,</span>
       <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;vapor mixing ratio (g/kg)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="calculating-scale-heights-for-temperature-and-air-density">
<h2><span class="section-number">5.7.2. </span>Calculating scale heights for temperature and air density<a class="headerlink" href="#calculating-scale-heights-for-temperature-and-air-density" title="Permalink to this headline">¶</a></h2>
<p>Here is equation 1 of the <a class="reference internal" href="hydrostat.html#hydro"><span class="std std-ref">Hydrostatic balance</span></a> notebook:</p>
<div class="math notranslate nohighlight">
\[\frac{ 1}{\overline{H_p}} =  \overline{ \left ( \frac{1 }{H} \right )} = \frac{\int_{0 }^{z}\!\frac{1}{H} dz^\prime  }{z-0} \]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[H=R_d T/g\]</div>
<p>and here is the Python code to do that integral:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="o">=</span><span class="mf">9.8</span>  <span class="c1">#don&#39;t worry about g(z) for this exercise</span>
<span class="n">Rd</span><span class="o">=</span><span class="mf">287.</span>  <span class="c1">#kg/m^3</span>
<span class="k">def</span> <span class="nf">calcScaleHeight</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">z</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the pressure scale height H_p</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    </span>
<span class="sd">    T: vector (float)</span>
<span class="sd">      temperature (K)</span>
<span class="sd">      </span>
<span class="sd">    p: vector (float) of len(T)</span>
<span class="sd">      pressure (pa)</span>
<span class="sd">      </span>
<span class="sd">    z: vector (float) of len(T</span>
<span class="sd">      height (m)</span>
<span class="sd">      </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    </span>
<span class="sd">    Hbar: vector (float) of len(T)</span>
<span class="sd">      pressure scale height (m)</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">TLayer</span><span class="o">=</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mf">2.</span>
    <span class="n">oneOverH</span><span class="o">=</span><span class="n">g</span><span class="o">/</span><span class="p">(</span><span class="n">Rd</span><span class="o">*</span><span class="n">TLayer</span><span class="p">)</span>
    <span class="n">Zthick</span><span class="o">=</span><span class="n">z</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">oneOverHbar</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">oneOverH</span><span class="o">*</span><span class="n">dz</span><span class="p">)</span><span class="o">/</span><span class="n">Zthick</span>
    <span class="n">Hbar</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">oneOverHbar</span>
    <span class="k">return</span> <span class="n">Hbar</span>
</pre></div>
</div>
</div>
</div>
<p>Similarly, equation (5) of the <a class="reference external" href="http://clouds.eos.ubc.ca/~phil/courses/atsc301/hydrostat.html#equation-hydro">hydrostatic balance notes</a>
is:</p>
<div class="math notranslate nohighlight">
\[\frac{d\rho }{\rho} = - \left ( \frac{1 }{H} + 
                   \frac{1 }{T} \frac{dT }{dz} \right ) dz \equiv - \frac{dz }{H_\rho} \]</div>
<p>Which leads to</p>
<div class="math notranslate nohighlight">
\[\frac{ 1}{\overline{H_\rho}}  = \frac{\int_{0 }^{z}\!\left [ \frac{1}{H} + \frac{1 }{T} \frac{dT }{dz} \right ] dz^\prime  }{z-0} \]</div>
<p>and the following python function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calcDensHeight</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">z</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the density scale height H_rho</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    </span>
<span class="sd">    T: vector (float)</span>
<span class="sd">      temperature (K)</span>
<span class="sd">      </span>
<span class="sd">    p: vector (float) of len(T)</span>
<span class="sd">      pressure (pa)</span>
<span class="sd">      </span>
<span class="sd">    z: vector (float) of len(T</span>
<span class="sd">      height (m)</span>
<span class="sd">      </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    </span>
<span class="sd">    Hbar: vector (float) of len(T)</span>
<span class="sd">      density scale height (m)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">TLayer</span><span class="o">=</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mf">2.</span>
    <span class="n">dTdz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">oneOverH</span><span class="o">=</span><span class="n">g</span><span class="o">/</span><span class="p">(</span><span class="n">Rd</span><span class="o">*</span><span class="n">TLayer</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">TLayer</span><span class="o">*</span><span class="n">dTdz</span><span class="p">)</span>
    <span class="n">Zthick</span><span class="o">=</span><span class="n">z</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">oneOverHbar</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">oneOverH</span><span class="o">*</span><span class="n">dz</span><span class="p">)</span><span class="o">/</span><span class="n">Zthick</span>
    <span class="n">Hbar</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">oneOverHbar</span>
    <span class="k">return</span> <span class="n">Hbar</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="how-do-overline-h-p-and-overline-h-rho-compare-for-the-tropical-sounding">
<h3><span class="section-number">5.7.2.1. </span>How do <span class="math notranslate nohighlight">\(\overline{H_p}\)</span> and <span class="math notranslate nohighlight">\(\overline{H_\rho}\)</span> compare for the tropical sounding?<a class="headerlink" href="#how-do-overline-h-p-and-overline-h-rho-compare-for-the-tropical-sounding" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sounding</span><span class="o">=</span><span class="s1">&#39;tropics&#39;</span>
<span class="c1">#</span>
<span class="c1"># grab the dataframe and get the sounding columns</span>
<span class="c1">#</span>
<span class="n">df</span><span class="o">=</span><span class="n">sound_dict</span><span class="p">[</span><span class="n">sounding</span><span class="p">]</span>
<span class="n">z</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">Temp</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">press</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;press&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># limit calculation to bottom 10 km</span>
<span class="c1">#</span>
<span class="n">hit</span><span class="o">=</span><span class="n">z</span><span class="o">&lt;</span><span class="mf">10000.</span>
<span class="n">zL</span><span class="p">,</span><span class="n">pressL</span><span class="p">,</span><span class="n">TempL</span><span class="o">=</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">hit</span><span class="p">],</span><span class="n">press</span><span class="p">[</span><span class="n">hit</span><span class="p">],</span><span class="n">Temp</span><span class="p">[</span><span class="n">hit</span><span class="p">])</span>
<span class="n">rhoL</span><span class="o">=</span><span class="n">pressL</span><span class="o">/</span><span class="p">(</span><span class="n">Rd</span><span class="o">*</span><span class="n">TempL</span><span class="p">)</span>
<span class="n">Hbar</span><span class="o">=</span> <span class="n">calcScaleHeight</span><span class="p">(</span><span class="n">TempL</span><span class="p">,</span><span class="n">pressL</span><span class="p">,</span><span class="n">zL</span><span class="p">)</span>
<span class="n">Hrho</span><span class="o">=</span> <span class="n">calcDensHeight</span><span class="p">(</span><span class="n">TempL</span><span class="p">,</span><span class="n">pressL</span><span class="p">,</span><span class="n">zL</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pressure scale height for the </span><span class="si">{}</span><span class="s2"> sounding is </span><span class="si">{:5.2f}</span><span class="s2"> km&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sounding</span><span class="p">,</span><span class="n">Hbar</span><span class="o">*</span><span class="mf">1.e-3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;density scale height for the </span><span class="si">{}</span><span class="s2"> is </span><span class="si">{:5.2f}</span><span class="s2"> km&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sounding</span><span class="p">,</span><span class="n">Hrho</span><span class="o">*</span><span class="mf">1.e-3</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="how-well-do-these-average-values-represent-the-pressure-and-density-profiles">
<h3><span class="section-number">5.7.2.2. </span>How well do these average values represent the pressure and density profiles?<a class="headerlink" href="#how-well-do-these-average-values-represent-the-pressure-and-density-profiles" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">theFig</span><span class="p">,</span><span class="n">theAx</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">Temp</span><span class="p">,</span><span class="n">press</span><span class="o">/</span><span class="mf">100.</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># need to flip the y axis since pressure decreases with height</span>
<span class="c1">#</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">tickvals</span><span class="o">=</span><span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">tickvals</span><span class="p">)</span>
<span class="n">majorFormatter</span> <span class="o">=</span> <span class="n">ticks</span><span class="o">.</span><span class="n">FormatStrFormatter</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">majorFormatter</span><span class="p">)</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">tickvals</span><span class="p">)</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mf">1000.</span><span class="p">,</span><span class="mf">50.</span><span class="p">])</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> temperature profile&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sounding</span><span class="p">))</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">)</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;pressure (hPa)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Now check the hydrostatic approximation by plotting the pressure column against</p>
<div class="math notranslate nohighlight">
\[p(z) = p_0 \exp \left (-z/\overline{H_p} \right )\]</div>
<p>vs. the actual sounding p(T):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">theAx</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="p">[</span><span class="n">hydroPress</span><span class="o">=</span><span class="n">pressL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">zL</span><span class="o">/</span><span class="n">Hbar</span><span class="p">)</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pressL</span><span class="o">/</span><span class="mf">100.</span><span class="p">,</span><span class="n">zL</span><span class="o">/</span><span class="mf">1000.</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;sounding&#39;</span><span class="p">)</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hydroPress</span><span class="o">/</span><span class="mf">100.</span><span class="p">,</span><span class="n">zL</span><span class="o">/</span><span class="mf">1000.</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;hydrostat approx&#39;</span><span class="p">)</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;height vs. pressure for tropics&#39;</span><span class="p">)</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;pressure (hPa)&#39;</span><span class="p">)</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;height (km)&#39;</span><span class="p">)</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">500</span><span class="p">,</span><span class="mi">1000</span><span class="p">])</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">tickVals</span><span class="o">=</span><span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">900</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">tickVals</span><span class="p">)</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">tickVals</span><span class="p">)</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Again plot the hydrostatic approximation</p>
<div class="math notranslate nohighlight">
\[\rho(z) = \rho_0 \exp \left (-z/\overline{H_\rho} \right )\]</div>
<p>vs. the actual sounding <span class="math notranslate nohighlight">\(\rho(z)\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">theAx</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">hydroDens</span><span class="o">=</span><span class="n">rhoL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">zL</span><span class="o">/</span><span class="n">Hrho</span><span class="p">)</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rhoL</span><span class="p">,</span><span class="n">zL</span><span class="o">/</span><span class="mf">1000.</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;sounding&#39;</span><span class="p">)</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hydroDens</span><span class="p">,</span><span class="n">zL</span><span class="o">/</span><span class="mf">1000.</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;hydrostat approx&#39;</span><span class="p">)</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;height vs. density for the tropics&#39;</span><span class="p">)</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;density ($kg\,m^{-3}$)&#39;</span><span class="p">)</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;height (km)&#39;</span><span class="p">)</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">theAx</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p><a name="oct7assign"></a></p>
</div>
<div class="section" id="assignment4-preview">
<h3><span class="section-number">5.7.2.3. </span>Assignment4 – (preview)<a class="headerlink" href="#assignment4-preview" title="Permalink to this headline">¶</a></h3>
<p>Add cells to this notebook to:</p>
<p>1.  Print out the density and pressure scale heights for each of the five soundings</p>
<p>2.  Define a function that takes a sounding dataframe and returns the “total precipitable water”, which is defined as:</p>
<div class="math notranslate nohighlight">
\[W = \int_0^{z_{top}} \rho_v dz \]</div>
<p>Do a change of units to convert <span class="math notranslate nohighlight">\(kg\,m^{-2}\)</span> to <span class="math notranslate nohighlight">\(cm\,m^{-2}\)</span> using the density of liquid water (1000 <span class="math notranslate nohighlight">\(kg\,m^{-3}\)</span>) – that is, turn the kg of water in the 1 square meter column into cubic meters and turn that into <span class="math notranslate nohighlight">\(cm/m^{-2}\)</span></p>
<p>3.  Use your function to print out W for all five soundings</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./week5"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="pandas-cheatsheet.html" title="previous page"><span class="section-number">5.5. </span>Pandas Cheatsheet</a>
    <a class='right-next' id="next-link" href="../week6/week6_topics.html" title="next page"><span class="section-number">6. </span>Week 6</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Philip Austin<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>