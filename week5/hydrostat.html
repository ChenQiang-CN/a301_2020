
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>5.3. Hydrostatic balance &#8212; ATSC 301</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://a301_web.eoas.ubc.ca/week5/hydrostat.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5.4. Reading &amp; Summarizing CSV Data" href="pandas_csv_intro.html" />
    <link rel="prev" title="5.2. Assignment 3: Split window H2O retrieval" href="assignment3.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://a301_web.eoas.ubc.ca/week5/hydrostat.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Hydrostatic balance" />
<meta property="og:description" content="Hydrostatic balance  In order to calculate the optical depth we need n, the number concentration of molecules at a particular height in the atmosphere.  This me" />


<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  
  <h1 class="site-logo" id="site-title">ATSC 301</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   ATSC 301: Fall 2020
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../week1/week1_topics.html">
   1. Week 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week2/week2_topics.html">
   2. Week 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week3/week3_topics.html">
   3. Week 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week4/week4_topics.html">
   4. Week 4
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="week5_topics.html">
   5. Week 5
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="testing.html">
     5.1. Notes on testing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="assignment3.html">
     5.2. Assignment 3: Split window H2O retrieval
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     5.3. Hydrostatic balance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pandas_csv_intro.html">
     5.4. Reading &amp; Summarizing CSV Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pandas-cheatsheet.html">
     5.5. Pandas Cheatsheet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hydrostatic_balance.html">
     5.6. Scale heights for typical atmospheric soundings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hydrostatic_balance.html#use-pd-dataframe-head-to-see-first-5-lines">
     5.7. Use pd.DataFrame.head to see first 5 lines
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week6/week6_topics.html">
   6. Week 6
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week7/week7_topics.html">
   7. Week 7
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week8/week8_topics.html">
   8. Week 8
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week9/week9_topics.html">
   9. Week 9
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments.html">
   10. Assignments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../review.html">
   11. Review/logistics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../notebooks.html">
   12. List of notebooks
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/week5/hydrostat.rst"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scale-heights">
   5.3.1. Scale Heights
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="hydrostatic-balance">
<span id="hydro"></span><h1><span class="section-number">5.3. </span>Hydrostatic balance<a class="headerlink" href="#hydrostatic-balance" title="Permalink to this headline">¶</a></h1>
<p>In order to calculate the optical depth we need <em>n</em>, the number concentration of molecules at a particular height in the atmosphere.  This means that we need to know the density as a function of height.</p>
<p>At large scales it is a very good approximation to assume
<em>hydrostatic balance</em>, which is the statement that the vertical
pressure differential across a layer provides exactly the amount of
force necessary to balance gravity, so the atmosphere is not rising or sinking:</p>
<div class="figure align-default" id="hydrofig">
<a class="reference internal image-reference" href="../_images/hydrostat.png"><img alt="../_images/hydrostat.png" src="../_images/hydrostat.png" style="width: 443.0px; height: 352.0px;" /></a>
<p class="caption"><span class="caption-number">Fig. 5.1 </span><span class="caption-text">Hydrostatic balance for a 1 <span class="math notranslate nohighlight">\(m^2\)</span> cross section of a layer</span><a class="headerlink" href="#hydrofig" title="Permalink to this image">¶</a></p>
</div>
<p>In symbols, the balance shown by <a class="reference internal" href="#hydrofig"><span class="std std-numref">Fig. 5.1</span></a> implies that:</p>
<div class="math notranslate nohighlight" id="equation-hydro">
<span class="eqno">(5.1)<a class="headerlink" href="#equation-hydro" title="Permalink to this equation">¶</a></span>\[  dp = - \rho g dz\]</div>
<p><strong>Question: is this the same pressure p as the local pressure given by
the equation of state</strong>: <span class="math notranslate nohighlight">\(p=\rho R_d T\)</span>?</p>
<div class="section" id="scale-heights">
<h2><span class="section-number">5.3.1. </span>Scale Heights<a class="headerlink" href="#scale-heights" title="Permalink to this headline">¶</a></h2>
<p>In Chapter 1 (p. 8) Roland introduces the idea of a characteristic
length scale for the variation of pressure in the atmosphere, and on page 14 he defines
the equation of state for dry air.   To get weighting functions for our
sounding retrievals we need to now the optical depth <span class="math notranslate nohighlight">\(\tau\)</span> vs. height,
which means that we need to know the gas density <span class="math notranslate nohighlight">\(\rho\)</span> as a function of height.
Below I show how to get <span class="math notranslate nohighlight">\(\rho(z)\)</span> for typical atmospheric conditions.</p>
<div class="math notranslate nohighlight">
\[p = p_0 \exp \left ( \frac{-z}{H_p} \right )\]</div>
<p>and on page</p>
<p>In words – <span class="math notranslate nohighlight">\(H_p\)</span> gives the height at which gravity wins out over the kinetic energy of the air molecules – warmer atmospheres take longer to decrease their pressure by a factor of <span class="math notranslate nohighlight">\(\exp(-H_p/H_p) = \exp(-1)\)</span> (the e-folding height) because the air molecules have more energy to travel higher.</p>
<ol class="arabic">
<li><p>Do pressure first: Rewrite <a class="reference internal" href="#equation-hydro">(5.1)</a> using the ideal gas law:</p>
<div class="math notranslate nohighlight" id="equation-hydro1">
<span class="eqno">(5.2)<a class="headerlink" href="#equation-hydro1" title="Permalink to this equation">¶</a></span>\[   dp = - \rho g dz = - \frac{p}{R_d T}  g dz = \frac{p}{H_p}\]</div>
<p>where <span class="math notranslate nohighlight">\(H_p=R_d T/g\)</span> is the pressure scale height.</p>
<div class="math notranslate nohighlight">
\[d\ln p = - \frac{dz }{H_p}\]</div>
<div class="math notranslate nohighlight">
\[\int_{p_0}^{p}\!\,d \ln p =  - \int_{0 }^{z}\!\frac{1}{H_p} dz^\prime\]</div>
<p>Since  temperature (and gravity) are changing with height, we need to know profiles of g(z) and T(z)
to go any further.  If we don’t have those profiles, then a useful approximation is to define a vertically averaged <span class="math notranslate nohighlight">\(H_p\)</span>, since
the average involves a large mass of air (about 10 metric tons/cubic meter), it will vary more slowly than the temperature at any one level on any given day, and we can still get a useful profile of pressure vs. height without having a specific sounding:</p>
<div class="math notranslate nohighlight" id="equation-pressavg">
<span class="eqno">(5.3)<a class="headerlink" href="#equation-pressavg" title="Permalink to this equation">¶</a></span>\[\frac{ 1}{\overline{H_p}} = \overline{ \left ( \frac{1 }{H_p} \right )} = \frac{\int_{0 }^{z}\!\frac{1}{H_p} dz^\prime  }{z-0}\]</div>
<p>Now we can replace the z integral by the average:</p>
<div class="math notranslate nohighlight">
\[\int_{p_0}^{p}\!\,d \ln p =  - \int_{0 }^{z}\!\frac{1}{H_p} dz^\prime = -\frac{z}{\overline{H_p}}\]</div>
<p>and  integrating the left-hand side:</p>
<div class="math notranslate nohighlight">
\[\ln p/p_0 = - \frac{z }{\overline{H_p}}\]</div>
<p>Taking exp of both sides gives the pressure with height:</p>
<div class="math notranslate nohighlight">
\[p = p_0 \exp \left ( - \frac{z }{\overline H_p} \right )\]</div>
<p>Values for <span class="math notranslate nohighlight">\(\overline{H_p}\)</span> are relatively constant for a particular climate regime, like midlatitude winter.</p>
</li>
<li><p>Now repeat this for density <span class="math notranslate nohighlight">\(\rho\)</span>.  We need to use the chain rule for the equation of state:</p>
<div class="math notranslate nohighlight">
\[\frac{dp }{dz}  = \frac{d }{dz}  (\rho R_d T) = R_d \left ( \frac{d\rho }{dz} T
+ \rho \frac{ dT}{dz} \right )  = - \rho g\]</div>
<div class="math notranslate nohighlight">
\[\frac{d\rho }{dz}  = -\frac{\rho }{T}  \left ( \frac{g }{R_d} + \frac{ dT}{dz} \right ) = - \rho \left ( \frac{1 }{H} +  \frac{1 }{T} \frac{dT }{dz} \right ) = - \frac{\rho}{H_\rho}\]</div>
<p>Bottom line – with this definition of the density scale height we’ve got an equation that looks like <a class="reference internal" href="#equation-hydro1">(5.2)</a>:</p>
<div class="math notranslate nohighlight" id="equation-densavg">
<span class="eqno">(5.4)<a class="headerlink" href="#equation-densavg" title="Permalink to this equation">¶</a></span>\[  \frac{d\rho }{\rho} = - \left ( \frac{1 }{H} +
                   \frac{1 }{T} \frac{dT }{dz} \right ) dz = - \frac{dz }{H_\rho}\]</div>
<p>Pull the same trick for the vertical average:</p>
<div class="math notranslate nohighlight" id="equation-denstrick">
<span class="eqno">(5.5)<a class="headerlink" href="#equation-denstrick" title="Permalink to this equation">¶</a></span>\[\frac{ 1}{\overline{H_\rho}} = \overline{ \left ( \frac{1 }{H_\rho} \right )} = \frac{\int_{0 }^{z}\!\frac{1}{H_\rho} dz^\prime  }{z-0}\]</div>
<p>We use this vertical average  in exactly the same way as before to
get the density profile:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  \ln \rho/\rho_0 =&amp; - \frac{z }{\overline{H_\rho }} \\
  \rho =&amp; \rho_0 \exp \left ( - \frac{z }{\overline H_\rho} \right )\end{aligned}\end{split}\]</div>
<p>In the hydrostatic.ipynb notebook I show that the midlatitude summer sounding gives
<span class="math notranslate nohighlight">\(H_p\approx7.8\)</span> km and <span class="math notranslate nohighlight">\(H_\rho \approx 9.5\)</span> km.  We can use the equations:</p>
<div class="math notranslate nohighlight">
\[p = p_o \exp ( -z/H_p)\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\rho = \rho_0 \exp ( -z/H_\rho)\]</div>
<p>To calculate the optical depth for various atmospheric conditions.</p>
</li>
</ol>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./week5"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="assignment3.html" title="previous page"><span class="section-number">5.2. </span>Assignment 3: Split window H2O retrieval</a>
    <a class='right-next' id="next-link" href="pandas_csv_intro.html" title="next page"><span class="section-number">5.4. </span>Reading &amp; Summarizing CSV Data</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Philip Austin<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>